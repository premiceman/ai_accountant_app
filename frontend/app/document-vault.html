<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Document Vault Â· AI Accountant</title>
  <link rel="stylesheet" href="/app/css/app.css" />
  <script defer src="/app/js/app.js"></script>
  <script defer src="/app/js/document-vault.js"></script>
</head>
<body>
  <div class="app-shell">
    <nav>
      <h1>AI ACCOUNTANT</h1>
      <a data-nav="dashboard" href="/app/dashboard">Dashboard</a>
      <a data-nav="vault" href="/app/document-vault">Document Vault</a>
      <a data-nav="profile" href="/app/profile">Profile</a>
      <button class="signout" type="button" data-action="signout">Sign out</button>
    </nav>
    <main>
      <div class="page-header">
        <div>
          <span class="badge">Welcome back</span>
          <h2 data-user-name>â€”</h2>
          <p class="subtitle">Upload payslips and bank statements to unlock monthly insights.</p>
        </div>
      </div>

      <section class="card upload-card" aria-live="polite">
        <div class="panel-header">
          <div>
            <h3>Document upload</h3>
            <p class="subtitle">Documents are stored in your secure R2 vault and processed through Docupipe.</p>
          </div>
        </div>
        <form id="upload-form" class="upload-form" novalidate>
          <input id="document-input" class="visually-hidden" type="file" accept="application/pdf" />
          <div id="upload-dropzone" class="upload-dropzone" tabindex="0">
            <div class="dropzone-content">
              <div class="dropzone-icon">ðŸ“„</div>
              <p class="dropzone-title">Drag &amp; drop a PDF here, or</p>
              <button type="button" class="button" id="document-button">Select PDF</button>
              <p class="dropzone-subtitle">Supported: payslips and bank statements (.pdf, max 20&nbsp;MB)</p>
            </div>
          </div>
        </form>
        <ul class="status-list" id="upload-status">
          <li class="status-item" data-step="upload">
            <span class="status-icon" aria-hidden="true"></span>
            <span class="status-label">Uploading to Cloudflare R2</span>
          </li>
          <li class="status-item" data-step="docupipe">
            <span class="status-icon" aria-hidden="true"></span>
            <span class="status-label">Running Docupipe workflow</span>
          </li>
          <li class="status-item" data-step="analytics">
            <span class="status-icon" aria-hidden="true"></span>
            <span class="status-label">Saving analytics</span>
          </li>
        </ul>
        <div class="upload-feedback" id="upload-feedback" role="status"></div>
      </section>

      <section class="card document-preview-card" aria-live="polite">
        <div class="panel-header">
          <div>
            <h3>Uploaded documents</h3>
            <p class="subtitle">Select a document to preview the PDF and inspect the JSON output returned by Docupipe.</p>
          </div>
        </div>
        <div class="document-preview-body">
          <div class="document-preview-list">
            <p class="empty-indicator" id="document-list-empty">No documents uploaded yet.</p>
            <ul id="document-list"></ul>
          </div>
          <div class="document-preview-panels">
            <div class="document-preview-header">
              <div class="document-preview-heading">
                <h4 id="document-preview-title">No documents available</h4>
                <p class="document-preview-meta" id="document-preview-meta"></p>
              </div>
              <div class="document-preview-actions">
                <button type="button" class="button button--ghost" id="document-download" disabled>
                  Download
                </button>
                <button type="button" class="button button--ghost" id="document-delete" disabled>
                  Delete
                </button>
              </div>
              <div class="document-preview-tags" id="document-preview-tags" hidden></div>
            </div>
            <div class="document-preview-pane document-preview-pane--pdf">
              <div class="document-preview-pane-header">
                <div class="document-preview-pane-title">PDF preview</div>
              </div>
              <div class="document-preview-frame-wrapper">
                <iframe id="document-preview-frame" title="Uploaded document preview" hidden loading="lazy"></iframe>
                <div class="document-preview-empty" id="document-preview-empty">Upload a document to preview it here.</div>
              </div>
            </div>
            <div class="document-preview-pane document-preview-pane--json">
              <div class="document-preview-pane-header">
                <div class="document-preview-pane-title">JSON output</div>
                <div class="document-preview-actions">
                  <button type="button" class="button button--ghost" id="document-json-copy" disabled>Copy JSON</button>
                </div>
              </div>
              <div class="document-json-wrapper">
                <pre id="document-json" hidden></pre>
                <div class="document-preview-empty" id="document-json-empty">Upload a document to view JSON output.</div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section class="card analytics-card">
        <div class="panel-header">
          <div>
            <h3>Monthly analytics</h3>
            <p class="subtitle">Select a month to view consolidated payslip and statement metrics.</p>
          </div>
          <div class="month-select">
            <label for="analytics-month">Month</label>
            <select id="analytics-month" name="analytics-month"></select>
          </div>
        </div>
        <div class="analytics-loading" id="analytics-loading" hidden>
          <span class="loading-spinner" aria-hidden="true"></span>
          <span>Loading analyticsâ€¦</span>
        </div>
        <div class="summary-grid" id="summary-grid"></div>
        <p class="empty-indicator" id="summary-empty" hidden>No analytics are available yet. Upload a payslip or bank statement to get started.</p>
      </section>

      <div class="card-grid">
        <section class="card" id="payslip-panel">
          <div class="panel-header">
            <div>
              <h3>Payslips</h3>
              <p class="subtitle">Net pay, tax and deductions for the selected month.</p>
            </div>
          </div>
          <div class="table-wrapper">
            <table class="table" id="payslip-table">
              <thead>
                <tr>
                  <th scope="col">Employer</th>
                  <th scope="col">Pay date</th>
                  <th scope="col">Gross</th>
                  <th scope="col">Net</th>
                  <th scope="col">Income tax</th>
                  <th scope="col">NI</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
          <p class="empty-indicator" id="payslip-empty" hidden>No payslips processed for this month yet.</p>
        </section>

        <section class="card" id="statement-panel">
          <div class="panel-header">
            <div>
              <h3>Bank statements</h3>
              <p class="subtitle">Track income, spend and cashflow from your accounts.</p>
            </div>
          </div>
          <div class="table-wrapper">
            <table class="table" id="statement-table">
              <thead>
                <tr>
                  <th scope="col">Account</th>
                  <th scope="col">Opening</th>
                  <th scope="col">Closing</th>
                  <th scope="col">Income</th>
                  <th scope="col">Spend</th>
                  <th scope="col">Net</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
          <div class="top-transactions" id="statement-top" hidden>
            <h4>Top transactions</h4>
            <ul id="transaction-list"></ul>
          </div>
          <p class="empty-indicator" id="statement-empty" hidden>No statements processed for this month yet.</p>
        </section>
      </div>
    </main>
  </div>
</body>
</html>
