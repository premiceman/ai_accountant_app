<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard · AI Accountant</title>
    <link rel="stylesheet" href="/app/css/app.css" />
    <script defer src="/app/js/app.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script defer src="/app/js/dashboard.js"></script>
  </head>
<body>
  <div class="app-shell">
    <nav>
      <h1>AI ACCOUNTANT</h1>
      <a data-nav="dashboard" href="/app/dashboard">Dashboard</a>
      <a data-nav="vault" href="/app/document-vault">Document Vault</a>
      <a data-nav="profile" href="/app/profile">Profile</a>
      <button class="signout" type="button" data-action="signout">Sign out</button>
    </nav>
    <main>
      <div class="page-header">
        <div>
          <span class="badge">Financial overview</span>
          <h2 data-user-name>—</h2>
          <p class="subtitle">Timeseries analytics generated from your processed payslips and bank statements.</p>
        </div>
      </div>

      <section class="card">
        <div class="panel-header">
          <div>
            <h3>Document completeness</h3>
            <p class="subtitle">See which employers or banks are missing documents for this month.</p>
          </div>
          <div>
            <span class="badge" id="completeness-month">—</span>
          </div>
        </div>
        <div class="analytics-loading" id="completeness-loading" hidden>
          <span class="loading-spinner" aria-hidden="true"></span>
          <span>Checking for missing documents…</span>
        </div>
        <div id="completeness-body" class="gap-list"></div>
        <p class="empty-indicator" id="completeness-empty">Upload a payslip or bank statement to start tracking completeness.</p>
      </section>

      <section class="card analytics-card">
        <div class="panel-header">
          <div>
            <h3>Dashboard</h3>
            <p class="subtitle">Track income, spend, cashflow, and net worth trends over time.</p>
          </div>
          <div>
            <span class="badge" id="dashboard-months">No data yet</span>
          </div>
        </div>
        <div class="analytics-loading" id="dashboard-loading" hidden>
          <span class="loading-spinner" aria-hidden="true"></span>
          <span>Loading analytics…</span>
        </div>
        <div class="summary-grid" id="dashboard-summary"></div>
        <p class="empty-indicator" id="dashboard-empty" hidden>No analytics are available yet. Upload documents to unlock the dashboard.</p>
      </section>

      <section class="card" id="missing-docs-card">
        <div class="panel-header">
          <div>
            <h3>Missing documents</h3>
            <p class="subtitle">Identify gaps by month and jump straight to the Vault to upload what’s missing.</p>
          </div>
          <div class="missing-docs-controls">
            <label class="sr-only" for="missing-docs-month">Filter by month</label>
            <select id="missing-docs-month" aria-label="Filter missing documents by month"></select>
            <a class="btn" id="missing-docs-resolve" href="/app/document-vault">Resolve all</a>
          </div>
        </div>
        <div class="missing-docs-body" id="missing-docs-body">
          <p class="empty-indicator" id="missing-docs-empty">No missing documents detected.</p>
        </div>
      </section>

      <div class="card-grid">
        <section class="card highlight-card">
          <div class="panel-header">
            <div>
              <h3>Net worth snapshot</h3>
              <p class="subtitle">Latest combined balances across all uploaded statements.</p>
            </div>
          </div>
          <div class="hero-metric">
            <p class="metric-label">Aggregated net worth</p>
            <p class="hero-value" id="networth-hero">—</p>
            <p class="metric-subtext" id="networth-change" hidden></p>
          </div>
        </section>

        <section class="card highlight-card">
          <div class="panel-header">
            <div>
              <h3>Run rate &amp; savings</h3>
              <p class="subtitle">Average monthly inflows, outflows, and surplus based on uploaded data.</p>
            </div>
          </div>
          <div class="runrate-grid" id="runrate-grid">
            <div class="metric-block">
              <p class="metric-label">Avg monthly income</p>
              <p class="metric-value" id="runrate-income">—</p>
            </div>
            <div class="metric-block">
              <p class="metric-label">Avg monthly spend</p>
              <p class="metric-value" id="runrate-spend">—</p>
            </div>
            <div class="metric-block">
              <p class="metric-label">Savings rate</p>
              <p class="metric-value" id="runrate-savings">—</p>
            </div>
          </div>
        </section>
      </div>

      <div class="card-grid">
        <section class="card">
          <div class="panel-header">
            <div>
              <h3>Cashflow over time</h3>
              <p class="subtitle">Income, spend, and net cashflow by month.</p>
            </div>
          </div>
          <div class="chart-container">
            <canvas id="cashflow-chart" role="img" aria-label="Cashflow line chart"></canvas>
            <p class="empty-indicator" id="cashflow-chart-empty" hidden>No chart data yet.</p>
          </div>
          <div class="table-wrapper">
            <table class="table" id="cashflow-table">
              <thead>
                <tr>
                  <th scope="col">Month</th>
                  <th scope="col">Income</th>
                  <th scope="col">Spend</th>
                  <th scope="col">Net cashflow</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
          <p class="empty-indicator" id="cashflow-empty" hidden>No cashflow data yet.</p>
        </section>

        <section class="card">
          <div class="panel-header">
            <div>
              <h3>Net worth trend</h3>
              <p class="subtitle">Total closing balances across all statements per month.</p>
            </div>
          </div>
          <div class="chart-container">
            <canvas id="networth-chart" role="img" aria-label="Net worth line chart"></canvas>
            <p class="empty-indicator" id="networth-chart-empty" hidden>No net worth data yet.</p>
          </div>
          <div class="table-wrapper">
            <table class="table" id="networth-table">
              <thead>
                <tr>
                  <th scope="col">Month</th>
                  <th scope="col">Total balance</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
          <p class="empty-indicator" id="networth-empty" hidden>No net worth data yet.</p>
        </section>
      </div>

      <div class="card-grid">
        <section class="card">
          <div class="panel-header">
            <div>
              <h3>Top spending categories</h3>
              <p class="subtitle">Largest outgoings grouped by category across all months.</p>
            </div>
          </div>
          <div class="chart-container">
            <canvas id="category-chart" role="img" aria-label="Spending by category"></canvas>
            <p class="empty-indicator" id="category-chart-empty" hidden>No category chart available yet.</p>
          </div>
          <div class="table-wrapper">
            <table class="table" id="category-table">
              <thead>
                <tr>
                  <th scope="col">Category</th>
                  <th scope="col">Total spend</th>
                  <th scope="col">Share</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
          <p class="empty-indicator" id="category-empty" hidden>No spending categories available yet.</p>
        </section>

        <section class="card" id="insights-card">
          <div class="panel-header">
            <div>
              <h3>AI insights</h3>
              <p class="subtitle">OpenAI-generated commentary based on your uploaded documents.</p>
            </div>
          </div>
          <div class="insights-body" id="insights-body">
            <p class="empty-indicator">Insights will appear here once analytics are available.</p>
          </div>
        </section>

        <section class="card">
          <div class="panel-header">
            <div>
              <h3>Payslip distribution</h3>
              <p class="subtitle">Histogram of net pay values across uploaded payslips.</p>
            </div>
          </div>
          <div class="chart-container">
            <canvas id="payroll-chart" role="img" aria-label="Payslip histogram"></canvas>
            <p class="empty-indicator" id="payroll-chart-empty" hidden>No payslip data yet.</p>
          </div>
        </section>
      </div>
    </main>
  </div>
</body>
</html>
